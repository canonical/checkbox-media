#!/usr/bin/env python3

import argparse
import sys

from intel_gpu_top_parser import parse


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description=(
            "Parse json file generated by `intel_gpu_tool -J` to"
            "check if GPU is being used"
        )
    )
    parser.add_argument("logfile", help="Path to the log file to parse.")
    args = parser.parse_args()
    gpu_average = parse(args.logfile)
    if gpu_average:
        print("GPU is used (average: {:.2f}%)".format(gpu_average))
    else:
        sys.exit("Error: GPU is not used.")
